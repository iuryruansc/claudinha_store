<%- include('../../partials/header.ejs') %>
<%- include('../../partials/navbar.ejs') %>

<body>
    <main class="main-content">
        <div class="container">
            <h2 class="h4 my-4"><i class="bi bi-bar-chart-line-fill me-2"></i>Relatório de Desempenho de Produtos</h2>

            <div class="card shadow-sm mb-4">
                <div class="card-body">
                    <form method="GET" action="/admin/relatorios/produtos" class="row g-3 align-items-end">
                        <div class="col-md-5">
                            <label for="dataInicio" class="form-label">Data de Início</label>
                            <input type="date" name="dataInicio" id="dataInicio" class="form-control" value="<%= filters.dataInicio %>">
                        </div>
                        <div class="col-md-5">
                            <label for="dataFim" class="form-label">Data de Fim</label>
                            <input type="date" name="dataFim" id="dataFim" class="form-control" value="<%= filters.dataFim %>">
                        </div>
                        <div class="col-md-2">
                            <button type="submit" class="btn btn-primary w-100">Gerar Relatório</button>
                        </div>
                    </form>
                </div>
            </div>

            <div class="card shadow-sm">
                <div class="card-header">Produtos Vendidos no Período</div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table id="table-data" class="table table-striped table-hover">
                            <thead class="table-light">
                                <tr>
                                    <th>Produto</th>
                                    <th class="text-center">Unidades Vendidas</th>
                                    <th class="text-end">Faturamento Gerado</th>
                                    <th class="text-end">Custo Total</th>
                                    <th class="text-end">Lucro Gerado</th>
                                </tr>
                            </thead>
                            <tbody>
                                    <% relatorio.forEach(produto => { %>
                                        <tr>
                                            <td class="fw-semibold"><%= produto.nome %></td>
                                            <td class="text-center"><%= produto.quantidadeVendida %></td>
                                            <td class="text-end"><%= produto.faturamento.toLocaleString('pt-BR', {style:'currency', currency:'BRL'}) %></td>
                                            <td class="text-end text-muted"><%= produto.custo.toLocaleString('pt-BR', {style:'currency', currency:'BRL'}) %></td>
                                            <td class="text-end fw-bold <%= produto.lucro >= 0 ? 'text-success' : 'text-danger' %>">
                                                <%= produto.lucro.toLocaleString('pt-BR', {style:'currency', currency:'BRL'}) %>
                                            </td>
                                        </tr>
                                    <% }) %>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </main>
    <%- include('../../partials/footer.ejs') %>
</body>
</html>